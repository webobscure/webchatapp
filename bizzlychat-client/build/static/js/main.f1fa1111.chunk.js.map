{"version":3,"sources":["components/Chat/Chat.js","components/Join/Join.js","components/TextContainer/TextContainer.js","components/Messages/Message/Message.js","components/Messages/Messages.js","components/InfoBar/InfoBar.js","components/Input/Input.js","components/VideoCall/VideoCall.js","App.js","index.js","assets/online.png","assets/close.png"],"names":["socket","options","value","label","Join","handleChange","selectedOption","setState","room","console","log","state","inputPressed","event","name","target","this","onSubmit","handleSubmit","className","placeholder","type","onChange","onClick","preventDefault","to","Component","TextContainer","users","map","key","alt","src","onlineIcon","Message","message","text","user","isSentByCurrentUser","time","moment","format","trimmedName","trim","toLowerCase","ReactEmoji","emojify","Messages","messages","i","InfoBar","href","closeIcon","Input","setMessage","sendMessage","onKeyPress","e","Chat","location","useState","setName","setRoom","setUsers","setMessages","ENDPOINT","useEffect","queryString","parse","search","io","connect","emit","error","alert","on","VideoCall","UserVideo","PartnerVideo","incomingCall","yourID","setYourID","stream","setStream","receivingCall","setReceivingCall","caller","setCaller","callerSignal","setCallerSignal","callAccepted","setCallAccepted","userVideo","useRef","partnerVideo","current","navigator","mediaDevices","getUserMedia","video","audio","then","srcObject","id","data","from","signal","playsInline","muted","ref","autoPlay","peer","Peer","initiator","trickle","Object","keys","userToCall","signalData","callPeer","App","path","exact","component","render","props","ReactDOM","document","querySelector","module","exports"],"mappings":"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","file":"static/js/main.f1fa1111.chunk.js","sourcesContent":["import React, { useState, useEffect} from \"react\";\r\nimport queryString from 'query-string';\r\nimport io from \"socket.io-client\";\r\n\r\n\r\n\r\n//components\r\nimport TextContainer from '../TextContainer/TextContainer';\r\nimport Messages from '../Messages/Messages';\r\nimport InfoBar from '../InfoBar/InfoBar';\r\nimport Input from '../Input/Input';\r\n\r\nimport './Chat.css';\r\n\r\nlet socket;\r\nconst Chat = ({ location }) => {\r\n  const [name, setName] = useState('');\r\n  const [room, setRoom] = useState('');\r\n  const [users, setUsers] = useState('');\r\n  const [time] = useState('');\r\n  const [message, setMessage] = useState('');\r\n  const [messages, setMessages] = useState([]);\r\n  const ENDPOINT = 'https://gardi-systems.herokuapp.com/';\r\n     \r\n    \r\n  useEffect(() => {\r\n    const { name, room } = queryString.parse(location.search);\r\n\r\n    socket = io.connect(ENDPOINT);\r\n \r\n    setRoom(room);\r\n    setName(name)\r\n    socket.emit('join', { name, room }, (error) => {\r\n      if(error) {\r\n        alert(error);\r\n      }\r\n    });\r\n  }, [ENDPOINT, location.search]);\r\n  \r\n  useEffect(() => {\r\n    socket.on('message', message => {\r\n      setMessages(messages => [ ...messages, message ]);\r\n    });\r\n    \r\n    socket.on(\"roomData\", ({ users }) => {\r\n      setUsers(users);\r\n    });\r\n}, []);\r\n\r\n//function to send message\r\n  const sendMessage = (event) => {\r\n    event.preventDefault();\r\n\r\n    if(message) {\r\n      socket.emit('sendMessage', message, () => setMessage('') );\r\n    }\r\n  }\r\n  \r\n  // <VideoCall users={users} />\r\n  return (\r\n    <div className=\"outerContainer\">\r\n      <div className=\"container\">\r\n          <InfoBar room={room} />\r\n          <Messages messages={messages} name={name} time={time} />\r\n          <Input message={message} setMessage={setMessage} sendMessage={sendMessage} />\r\n      </div>\r\n      <TextContainer users={users} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;","import React, {Component} from 'react'\r\nimport { Link } from 'react-router-dom'\r\nimport Select from 'react-select'\r\nimport './Join.css'\r\nconst options = [\r\n    { value: 'F.R.I.E.N.D.S.', label: 'F.R.I.E.N.D.S.' },\r\n    { value: 'American Horror Story', label: 'American Horror Story' },\r\n    { value: 'The Big Bang Theory', label: 'The Big Bang Theory' },\r\n    { value: 'Gravity Falls', label: 'Gravity Falls' },\r\n    { value: 'The Simpsons', label: 'The Simpsons' },\r\n  ];\r\nexport default class Join extends Component {\r\n    constructor() {\r\n        super()\r\n        this.state = {\r\n            name: '',\r\n            room: '',\r\n            selectedOption:null\r\n        }\r\n    }\r\n    handleChange = (selectedOption) => {\r\n        this.setState(\r\n          { room: selectedOption.value },\r\n          () => console.log(this.state.room)\r\n        );\r\n        this.setState(\r\n            {selectedOption},\r\n          () => console.log(`Option selected:`, this.state.selectedOption )\r\n\r\n        )\r\n       \r\n       \r\n    }\r\n   \r\n    inputPressed = (event) => {\r\n        this.setState({name : event.target.value})\r\n    }\r\n    \r\n    render() {\r\n        const { room, name,selectedOption } = this.state;\r\n        return (\r\n            <form onSubmit={this.handleSubmit}>\r\n                <div className=\"joinOuterContainer\">\r\n                    <div className=\"joinInnerContainer\">\r\n                        <h1 className=\"head\">Gardi-systems</h1>\r\n                        <div><input placeholder=\"Your name\" className=\"joinInput\" type=\"text\" onChange={this.inputPressed} value={name}/></div>\r\n                        <div>\r\n                        <Select\r\n                          value={selectedOption}\r\n                          onChange={this.handleChange}\r\n                          options={options}\r\n                          className=\"mt-20\"\r\n                        />\r\n                        </div>\r\n                        <Link onClick={event => (!name || !room) ? event.preventDefault() : null} to={`/chat?name=${name}&room=${room}`}>\r\n                            <button className=\"button mt-20\" type=\"submit\" value=\"Submit\">Sign in room</button>\r\n                        </Link>\r\n                        <Link onClick={event => (!name || !room) ? event.preventDefault() : null} to={`/chatweb?name=${name}&room=${room}`}>\r\n                            <button className=\"button mt-20\" type=\"submit\" value=\"Submit\">Sign in webroom</button>\r\n                        </Link>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        )\r\n    }\r\n}\r\n","import React from 'react';\r\n//assets\r\nimport onlineIcon from '../../assets/online.png';\r\n\r\nimport './TextContainer.css';\r\n\r\nconst TextContainer = ({ users }) => {\r\n\r\n\r\n  \r\n\r\n\r\n  return (\r\n    <div className=\"textContainer\">\r\n    \r\n    {\r\n      users\r\n        ? (\r\n          <div>\r\n            <h1>People currently chatting:</h1>\r\n            <div className=\"activeContainer\">\r\n              <h2>\r\n                {users.map(({name}) => (\r\n                  <div key={name} className=\"activeItem\">\r\n                    {name}\r\n                    <img  className=\"online\"alt=\"Online Icon\" src={onlineIcon}/>\r\n                  </div>\r\n                   \r\n                ))}\r\n                \r\n              </h2>\r\n            </div>\r\n          </div>\r\n        )\r\n        : null\r\n    }\r\n  </div>\r\n  )\r\n  \r\n};\r\n\r\nexport default TextContainer;","import React from 'react';\r\nimport moment from 'moment'\r\nimport './Message.css';\r\n\r\nimport ReactEmoji from 'react-emoji';\r\n\r\nconst Message = ({ message: { text, user }, name }) => {\r\n  let isSentByCurrentUser = false;\r\n  let time = moment().format('h:mm a')\r\n  const trimmedName = name.trim().toLowerCase();\r\n\r\n  if(user === trimmedName) {\r\n    isSentByCurrentUser = true;\r\n  }\r\n\r\n  return (\r\n    isSentByCurrentUser\r\n      ? (\r\n        <div className=\"messageContainer justifyEnd\">\r\n          <p className=\"sentText pr-10\"> {time} </p>\r\n          <p className=\"sentText pr-10\">{trimmedName}</p>\r\n          <div className=\"messageBox backgroundBlue\">\r\n            <p className=\"messageText colorWhite\">{ReactEmoji.emojify(text)}</p>\r\n          </div>\r\n        </div>\r\n        )\r\n        : (\r\n          <div className=\"messageContainer justifyStart\">\r\n            <div className=\"messageBox backgroundLight\">\r\n              <p className=\"messageText colorDark\">{ReactEmoji.emojify(text)}</p>\r\n            </div>\r\n            <p className=\"sentText pl-10 \">{user}</p>\r\n            <p className=\"sentText pl-10\"> {time}</p>\r\n          </div>\r\n        )\r\n  );\r\n}\r\n\r\nexport default Message;","import React from 'react';\r\n\r\nimport ScrollToBottom from 'react-scroll-to-bottom';\r\n\r\nimport Message from './Message/Message';\r\n\r\nimport './Messages.css';\r\n\r\nconst Messages = ({ messages, name, time }) => (\r\n  <ScrollToBottom className=\"messages\">\r\n    {messages.map((message, i) => <div key={i}><Message message={message} name={name} time={time}/></div>)}\r\n  </ScrollToBottom>\r\n);\r\n\r\nexport default Messages;","import React from 'react';\r\n\r\n//asets\r\nimport onlineIcon from '../../assets/online.png';\r\nimport closeIcon from '../../assets/close.png';\r\n\r\nimport './InfoBar.css';\r\n\r\nconst InfoBar = ({ room }) => (\r\n  <div className=\"infoBar\">\r\n    <div className=\"leftInnerContainer\">\r\n      <img className=\"onlineIcon\" src={onlineIcon} alt=\"online icon\" />\r\n      <h3>{room}</h3>\r\n    </div>\r\n    <div className=\"rightInnerContainer\">\r\n      <a href=\"/\"><img src={closeIcon} alt=\"close icon\" /></a>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport default InfoBar;","import React from 'react';\r\n\r\nimport './Input.css';\r\n\r\n\r\n\r\nconst Input = ({ setMessage, sendMessage, message }) => {\r\n \r\nreturn (\r\n          <form className=\"form\">\r\n    <input\r\n      className=\"input\"\r\n      type=\"text\"\r\n      placeholder=\"Type a message...\"\r\n      value={message}\r\n      onChange={({ target: { value } }) => setMessage(value)}\r\n      onKeyPress={event => event.key === 'Enter' ? sendMessage(event) : null}\r\n    />\r\n    \r\n\r\n    <button className=\"sendButton\" onClick={e => sendMessage(e)}>Send</button>\r\n  </form>\r\n)\r\n  \r\n}\r\n\r\nexport default Input","import React, { useEffect, useRef, useState } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport Peer from 'simple-peer'\r\nimport queryString from 'query-string';\r\nimport InfoBar from \"../InfoBar/InfoBar\";\r\n\r\nimport './VideoCall.css'\r\n\r\n\r\nconst VideoCall = ({location}) => {\r\n    const [yourID, setYourID] = useState(\"\");\r\n    const [name, setName] = useState('');\r\n    const [room, setRoom] = useState('');\r\n    const [stream, setStream] = useState();\r\n    const [receivingCall, setReceivingCall] = useState(false);\r\n    const [caller, setCaller] = useState(\"\");\r\n    const [callerSignal, setCallerSignal] = useState();\r\n    const [callAccepted, setCallAccepted] = useState(false);\r\n    const [users, setUsers] = useState({});\r\n    const userVideo = useRef();\r\n    const partnerVideo = useRef()\r\n    const socket = useRef()\r\n    const ENDPOINT = 'http://localhost:8080/'\r\n    useEffect(() => {\r\n        const { name, room } = queryString.parse(location.search)\r\n        setName(name)\r\n        setRoom(room)\r\n        socket.current = io.connect(ENDPOINT);\r\n        navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {\r\n          setStream(stream);\r\n          if (userVideo.current) {\r\n            userVideo.current.srcObject = stream;\r\n          }\r\n        })\r\n    \r\n        socket.current.on(\"yourID\", (id) => {\r\n          setYourID(id);\r\n        })\r\n       \r\n        socket.current.on(\"allUsers\", (users) => {\r\n          setUsers(users);\r\n        })\r\n    \r\n        socket.current.on(\"hey\", (data) => {\r\n          setReceivingCall(true);\r\n          setCaller(data.from);\r\n          setCallerSignal(data.signal);\r\n        })\r\n      }, [ENDPOINT,location.search]);\r\n    \r\n      function callPeer(id) {\r\n        const peer = new Peer({\r\n          initiator: true,\r\n          trickle: false,\r\n          stream: stream,\r\n        });\r\n    \r\n        peer.on(\"signal\", data => {\r\n          socket.current.emit(\"callUser\", { userToCall: id, signalData: data, from: yourID })\r\n        })\r\n    \r\n        peer.on(\"stream\", stream => {\r\n          if (partnerVideo.current) {\r\n            partnerVideo.current.srcObject = stream;\r\n          }\r\n        });\r\n    \r\n        socket.current.on(\"callAccepted\", signal => {\r\n          setCallAccepted(true);\r\n          peer.signal(signal);\r\n        })\r\n    \r\n      }\r\n    \r\n      function acceptCall() {\r\n        setCallAccepted(true);\r\n        const peer = new Peer({\r\n          initiator: false,\r\n          trickle: false,\r\n          stream: stream,\r\n        });\r\n        peer.on(\"signal\", data => {\r\n          socket.current.emit(\"acceptCall\", { signal: data, to: caller })\r\n        })\r\n    \r\n        peer.on(\"stream\", stream => {\r\n          partnerVideo.current.srcObject = stream;\r\n        });\r\n    \r\n        peer.signal(callerSignal);\r\n      }\r\n    \r\n      let UserVideo;\r\n      if (stream) {\r\n        UserVideo = (\r\n          <video className=\"video-grid\"  playsInline muted ref={userVideo} autoPlay />\r\n        );\r\n      }\r\n    \r\n      let PartnerVideo;\r\n      if (callAccepted) {\r\n        PartnerVideo = (\r\n          <video className=\"video-grid\"  playsInline ref={partnerVideo} autoPlay />\r\n        );\r\n      }\r\n    \r\n      let incomingCall;\r\n      if (receivingCall) {\r\n        incomingCall = (\r\n          <div>\r\n            <h1>{caller} is calling you</h1>\r\n            <button className=\"incoming\" onClick={acceptCall}>Accept</button>\r\n          </div>\r\n        )\r\n      }\r\n      return (\r\n        <div className=\"box\">\r\n            <InfoBar room={room} />\r\n          <div className=\"row\">\r\n            {UserVideo}\r\n            {PartnerVideo}\r\n          </div>\r\n          <div className=\"row\">\r\n            {  \r\n            Object.keys(users).map(key => {\r\n              if (key === yourID) {\r\n                return null;\r\n              }\r\n              return (\r\n                <button key={key} className=\"incoming\" onClick={() => callPeer(key)}>Call {key} : {name}</button>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"row\">\r\n            {incomingCall}\r\n          </div>\r\n        </div>\r\n      );\r\n};\r\n\r\nexport default VideoCall","import React from 'react'\r\n\r\nimport { BrowserRouter as Router,Route} from 'react-router-dom'\r\n\r\n//components\r\nimport Join from './components/Join/Join'\r\nimport Chat from './components/Chat/Chat'\r\nimport VideoCall from './components/VideoCall/VideoCall'\r\n\r\n\r\nconst App = () => (\r\n    <Router>\r\n        <Route path=\"/\"  exact component={Join}/>\r\n        <Route path=\"/chat\" render={(props) => <Chat {...props} />} />\r\n        <Route path=\"/chatweb\" render={(props) => <VideoCall {...props} />} />\r\n\r\n        \r\n    </Router>\r\n)\r\n\r\nexport default App;","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './App'\r\n\r\nReactDOM.render(<App/>, document.querySelector('#root'))","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAYAAADgzO9IAAAAAXNSR0IArs4c6QAAAExJREFUCB1jbPh/le3lx5tNDIwMcQwg8J9hkTi/eh0LWJCBoRwoAAPlQDEGJrhKmDCIBupmQuYjs5lAZiILgNlAMRaQRSAz4UZCLQcAIwYaiAejKoYAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAHBJREFUGBmNkAEKwCAMA2VfGP2mrx3sOV2us6IymIXQGlNTW9zdhCqcZQm4dmelFUp+CZZa6sYpeUVIFyIixMqjCO51Wy5unQExuYSbSF5JASLqPsqRM21lOoWc89tagr3PSMgOiWlwnUeXWA/E78IfuAX270S3ydAAAAAASUVORK5CYII=\""],"sourceRoot":""}